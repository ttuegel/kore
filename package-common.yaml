- &version
  version: 0.20.0.0

- &legal
  license:             NCSA
  license-file:        LICENSE
  author:              "Runtime Verification, Inc."
  maintainer:          "thomas.tuegel@runtimeverification.com"
  copyright:           "2018-2020 Runtime Verification, Inc."

- &haskell
  default-extensions:
    - BangPatterns
    - ConstraintKinds
    - DataKinds
    - DefaultSignatures
    - DeriveDataTypeable
    - DeriveFoldable
    - DeriveFunctor
    - DeriveGeneric
    - DeriveTraversable
    - DerivingVia
    - DuplicateRecordFields
    - EmptyCase
    - ExistentialQuantification
    - FlexibleContexts
    - FlexibleInstances
    - FunctionalDependencies
    - GADTs
    - GeneralizedNewtypeDeriving
    - InstanceSigs
    - KindSignatures
    - LambdaCase
    - MultiParamTypeClasses
    - NamedFieldPuns
    - NoImplicitPrelude
    - OverloadedStrings
    - PatternSynonyms
    - RankNTypes
    - ScopedTypeVariables
    - StandaloneDeriving
    - TypeApplications
    - TypeFamilies
    - TypeOperators
    - TypeSynonymInstances
    - ViewPatterns
  ghc-options:
    - -fno-ignore-asserts
    - -Wall
    - -Wcompat
    - -Widentities
    - -Wincomplete-uni-patterns
    - -Wincomplete-record-updates
    - -Wpartial-fields
    - -Wredundant-constraints
    - -Wmissing-export-lists

- &flags
  release:
    description: Build a faster runtime, at the expense of a slower build.
    manual: true
    default: false

- &flag_threaded
  threaded:
    description: Use the threaded runtime. Recommended to disable for profiling.
    manual: true
    default: true

- &when_release
  when:
    - condition: "!flag(release)"
      ghc-options:
        - -fno-specialise

- &executable
  when:
    - condition: flag(threaded)
      then:
        ghc-options: -threaded -rtsopts "-with-rtsopts=-N -T -A32M -qn4"
      else:
        ghc-options: -rtsopts "-with-rtsopts=-A32M"
